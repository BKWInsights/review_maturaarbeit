# üè∏ Tournament Draw Evaluation

This Python script analyzes player distribution and pairing patterns across multiple tournament draws exported from **Badminton Tournament Planner (BTP)**.  
It builds on the merged output file (`all_MS_U13.xlsx`) generated by [`draw_parser.py`](../parser/draw_parser.py).

---

## Features

- Loads and processes draw data from `all_MS_U13.xlsx`
- Extracts draw numbers from filenames (e.g., `Ausl_1.xlsx`)
- Computes:
  - Group-wise player distribution
  - Pairings (2-player combinations)
  - Triplets and quadruplets
  - Unpaired combinations (with filtering logic)
  - Longest consecutive appearance streaks
- Prepares data for statistical testing (e.g., Chi¬≤)
- Exports all results to a single Excel file: `evaluation_of_draws.xlsx`

---

## Output Sheets

| Sheet Name           | Description                                                                 |
|----------------------|-----------------------------------------------------------------------------|
| **Group distribution** | Player counts per group across draws                                        |
| **Pairs of 2**         | Frequency and streaks of 2-player combinations                              |
| **Never together**     | Valid player pairs that never appeared together (filtered by seed/club)     |
| **Triplets**           | Frequency and streaks of 3-player combinations                              |
| **Quadruplets**        | Frequency and streaks of 4-player combinations                              |
| **Chi2 test**          | Raw counts for statistical validation of group distributions                |

---

## Dependencies

- Python 3.x
- `pandas` - data handling
- `openpyxl` - required Excel backend
- Standard libraries: `collections`, `itertools`, `re`

Install the required packages with:

```bash
pip install pandas openpyxl
```

---

## Usage

1. Ensure `all_MS_U13.xlsx` (or if chosen different category or age adjust accordingly) exists (generated by `draw_parser`)
2. Update the file path in the script if needed:
   ```df = pd.read_excel(r"D:\Maturaarbeit\all_MS_U13.xlsx")```
3. Run the script:
```bash
python evaluate_draws.py
```
4. Output will be saved to:
   `D:\Maturaarbeit\evaluation_of_draws.xlsx` by default, change to your destination folder path.

---

## Notes
This script assumes consistent column names and structure from `draw_parser.py`.

